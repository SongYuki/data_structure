CPU使用率：让CPU的使用率划出一条直线，比如就在50%的地方
有人能很娴熟的使用C/C#的各种语言特性，很快写出程序，有人写的程序编译好几次都不能通过，对编译错误束手无策。

有没有动过好奇心--这个程序为什么这么酷，如果是我来写，应该怎么做，有没有把好奇心转化为行动？

喜欢玩电脑会玩电脑的人，也会运用电脑解决实际问题，这也是我们要找的人才

Question：写一个程序，让用户来决定windows task manager的CPU占用率，程序越精简越好，计算机语言不限。可以实现下面三种情况
1.CPU的占用率固定在50%为一条直线
2.CPU的占用率为一条直线，但是具体占用率由命令行参数决定（参数范围1-100）
3.CPU的占用率状态是一个正弦曲线


MSRA IEG Microsoft Research Asia Innovation Engineering Group

System Idle Process 占用了CPU空闲的时间。系统中那么多的进程什么时候能够闲下来呢
这些程序或在等待用户的输入或在等待某些事件的发生，或者主动进入休眠状态

我们可以写一个程序，让它在任务管理器的刷新期间内一会儿忙一会儿闲，然后通过调节忙/闲的比例，就可以控制任务管理器中显示的CPU占用率

{解法一，简单的解法}
要操纵CPU的使用率曲线，就需要使CPU在一段时间内跑busy和idle两个不同的循环loop从而通过不同的时间比例来调节CPU的使用率

busy loop可以通过执行空循环来实现idle可以通过sleep()来实现

问题的关键在于如何控制两个loop的时间，我们先试验一下sleep一段时间然后循环n次，估算n的值

对于一个空循环for(int i=0;i<n;i++)如何估算这个最合适的n值呢？
CPU执行的是机器指令而最接近于机器指令的语言是汇编语言所以我们可以先把这个空循环简单携程汇编代码
loop:
mov dx i;
inc dx;
mov i dx;
cmp i n;
jl loop;

假设这段代码运行的CPU是2.4Ghz(2.4*10的9次方个时钟周期秒)
现代CPU每个时钟周期可以执行两条以上的代码(2.4*10^9)*2/5=9.6*10^8(循环/秒)也就是说CPU一秒钟可以运行这个空循环9.6*10^8次
如果我们让CPU工作一秒钟然后休息一秒钟波形很有可能就是锯齿状的，先达到一个峰值>50%，然后跌到一个很低的占用率

尝试降低两个数量级，n=9.6*10^6睡眠时间相应改为10mm sleep(10) 10毫秒是因为它不大也不小，比较接近windows的调度时间片。如果选太小（1ms）造成线程频繁地被唤醒和挂起，无形中又增加了内核时间的不确定性影响。

int main()
{
for(;;)
{
for(int i=0;i<9.6*10^6;i++)
;
Sleep(10);
}
return 0;
}

使用这种方法注意两点影响
1.尽量减少sleep/awake的频率，减少操作系统内核调度程序的干扰
2.尽量不要调用system call(I/O这些privilege instruction)因为它会导致很多不可控的内核运行时间

缺点：n值的可变性，一旦换了CPU重新估算N值。

